..
      Copyright European Organization for Nuclear Research (CERN)

      Licensed under the Apache License, Version 2.0 (the "License");
      You may not use this file except in compliance with the License.
      You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0

=================
Rucio RESTful API
=================

Each resource can be accessed or modified using specially formed URLs and the standard HTTP methods:

 * GET to read
 * POST to create
 * PUT to update
 * DELETE to remove

We require that all requests are done over SSL. The API supports JSON formats. Rucio uses OAuth_
to authenticate all API requests. The method is to get an authentication token, and use it for the rest of
the requests. Descriptions of the actions you may perform on each resource can be found below.


.. _OAuth: http://oauth.net/

Service
=======

+---------------+--------------------------------------+-------------+---------------------+
| Resource      | Description                          | Command     | Method              |
+===============+======================================+=============+=====================+
| :ref:`GET /`  | Discover server version information  | :ref:`ping` | :ref:`client_ping`  |
+---------------+--------------------------------------+-------------+---------------------+



Authentication
==============

+------------------------------------+-----------------------------------------------------------+--------------+
| Resource                           | Description                                               | Availability |
+====================================+===========================================================+==============+
| :ref:`GET auth/userpass`           | Retrieve an auth token with via username and password     |  OK          |
+------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET auth/x509`               | Retrieve an auth token with via a x509 certificate        |  OK          |
+------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET auth/gss`                | Retrieve an auth token with via a gss token               |  OK          |
+------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET auth/proxy`              | Retrieve an auth token with via a Globus proxy            |  No          |
+------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET auth/validate`           | Return accountname and expiration date, if token valid    |  OK          |
+------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET auth/register_api_token` | Authenticate a Rucio account for interaction with the API |  No          |
+------------------------------------+-----------------------------------------------------------+--------------+

Rucio account
=============

+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| Resource                             | Description                                       | Command                         | Method                    |
+======================================+===================================================+=================================+===========================+
| :ref:`POST accounts/`                | Create account                                    | :ref:`add_account`              | :ref:`client_add_account` |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| :ref:`GET accounts/{accountName}`    | Get account information                           | :ref:`rucio-admin account show` |                           |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| :ref:`PUT accounts/{accountName}`    | Update account information                        |  No                             |                           |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| :ref:`GET accounts/whoami`           | Get information about account whose token is used | :ref:`rucio whoami`             | :ref:`whoami`             |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| :ref:`GET accounts/`                 | List available accounts                           | :ref:`rucio-admin account list` | :ref:`list_accounts`      |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+
| :ref:`DELETE accounts/{accountName}` | Disable an account                                |  :ref:`rucio-admin account del` | :ref:`del_account`        |
+--------------------------------------+---------------------------------------------------+---------------------------------+---------------------------+

RSE (Rucio Storage Element)
============================

+----------------------------------------+-----------------------------------------------------------+--------------+
| Resource                               | Description                                               | Availability |
+========================================+===========================================================+==============+
| :ref:`POST rses/`                      | Create a RSE                                              |  No          |
+----------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET rses/{rseName}`              | Get RSE information                                       |  No          |
+----------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET rses/`                       | List available RSEs                                       |  OK          |
+----------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`DELETE rses/{rseName}`           | Disable a RSE                                             |  No          |
+----------------------------------------+-----------------------------------------------------------+--------------+


RSE Tag
=======

+-------------------------------------------------------+------------------------------------------+--------------+
| Resource                                              | Description                              | Availability |
+=======================================================+==========================================+==============+
| :ref:`POST /rses/{rseName}/tags/`                     | Tag a RSE                                |  No          |
+-------------------------------------------------------+------------------------------------------+--------------+
| :ref:`GET rses/tags/`                                 | List all RSE tags                        |  No          |
+-------------------------------------------------------+------------------------------------------+--------------+
| :ref:`GET rses/{rseName}/tags/`                       | List all tags associated to a RSE        |  No          |
+-------------------------------------------------------+------------------------------------------+--------------+
| :ref:`DELETE rses/{RSEName}/tags/{tagName}`           | Untag a RSE                              |  No          |
+-------------------------------------------------------+------------------------------------------+--------------+


Identity
========

+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------+
| Resource                                                                                   | Description                                                          | Availability |
+============================================================================================+======================================================================+==============+
| :ref:`POST accounts/{accountName}/identities/`                                             | Grant a \{userpass|x509|gss|proxy\} identity access to an account    |  No          |
+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------+
| :ref:`GET accounts/{accountName}/identities/`                                              | List all identities on an account                                    |  No          |
+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------+
| :ref:`GET identities/{userpass|x509|gss|proxy}/{identityString}/accounts/`                 | List all account memberships of an identity                          |  No          |
+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------+
| :ref:`DELETE accounts/{accountName}/identities/{userpass|x509|gss|proxy}/{identityString}` | Revoke a \{userpass|x509|gss|proxy\} identity's access to an account |  No          |
+--------------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------+


Scope
=====

+----------------------------------------------------------+-----------------------------------------------------------+--------------+
| Resource                                                 | Description                                               | Availability |
+==========================================================+===========================================================+==============+
| :ref:`POST accounts/{accountName}/scopes/`               | Create a scope                                            |  No          |
+----------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET accounts/{accountName}/scopes/`                | List available scopes for an account                      |  No          |
+----------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET scopes/`                                       | List all scopes                                           |  No          |
+----------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`DELETE accounts/{accountName}/scopes/{scopeName}`  | Delete a scope from an account                            |  No          |
+----------------------------------------------------------+-----------------------------------------------------------+--------------+


Dataset
=======

+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| Resource                                                           | Description                                               | Availability |
+====================================================================+===========================================================+==============+
| :ref:`POST datasets/{scopeName}/`                                  | Register a dataset                                        |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET datasets/{scopeName}/{datasetName}/`                     | List dataset content                                      |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET datasets/{scopeName}/{datasetName}`                      | List dataset meta-data                                    |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`PUT datasets/{datasetName}`                                  | Update dataset meta-data                                  |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`POST datasets/{scopeName}/{datasetName}/`                    | Add file(s) to a dataset                                  |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET datasets/{scopeName}/{datasetName}/{fileName}`           | Get file meta-data                                        |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET datasets/`                                               | Search datasets                                           |  No          |
+--------------------------------------------------------------------+-----------------------------------------------------------+--------------+


File
====

+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| Resource                                                              | Description                                               | Availability |
+=======================================================================+===========================================================+==============+
| :ref:`POST /locations/{locationName}/files/`                          | Register a file                                           |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`PUT /files/{scopeName}/{fileName}/`                             | Update file meta-data                                     |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET /files/{scopeName}/{fileName}`                              | Get file meta-data                                        |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET /files/{scopeName}/locations/`                              | List file replicas                                        |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET files/`                                                     | Search files                                              |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+


Replication rule & Transfer request
===================================

+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| Resource                                                              | Description                                               | Availability |
+=======================================================================+===========================================================+==============+
| :ref:`POST copy/`                                                     | Register transfer requests                                |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET copy/<transfer_id>`                                         | Query transfer status                                     |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`POST replications/`                                             | Register a replication rule                               |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET replications/`                                              | List replication rules                                    |  No          |
+-----------------------------------------------------------------------+-----------------------------------------------------------+--------------+


Subscriptions
=============

+----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| Resource                                                             | Description                                               | Availability |
+======================================================================+===========================================================+==============+
| :ref:`POST subscriptions/{accountName}/`                             | Register a subscription                                   |  No          |
+----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`DELETE subscriptions/{subscription_id}`                        | Delete a subscription                                     |  No          |
+----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET subscriptions/{subscription_id}`                           | Get subscription info                                     |  No          |
+----------------------------------------------------------------------+-----------------------------------------------------------+--------------+
| :ref:`GET subscriptions/`                                            | List all subscriptions                                    |  No          |
+----------------------------------------------------------------------+-----------------------------------------------------------+--------------+


.. Status legend:
.. Stable - feature complete, no major changes planned
.. Beta - usable for integrations with some bugs or missing minor functionality
.. Alpha - major functionality in place, needs feedback from API users and integrators
.. Prototype - very rough implementation, possible major breaking changes mid-version. Not recommended for integration
.. Planned - planned in a future version, depending on developer availability


